!///////////////////////////////////////////////////////////////////////////////
!// Initialization of the BIOS vectors that is not covered by regular applications
!// Copyright 2023 by T_chan
!//
!// R0 to R7: not preserved, R8 to R13: preserved, R14/R15: do not touch
!///////////////////////////////////////////////////////////////////////////////
    .globl _vectors_init
    .text

_vectors_init:

!///////////////////////////////////////////////////////////////////////////////
!// 
!///////////////////////////////////////////////////////////////////////////////
.ROMFONT_set_vector:
    mov.l ROMFONT_FUNC_ADDR, R1         !
    mov.l ROMFONT_VECTOR_ADDR, R2       ! 0xAC0000B4
    mov.l R1, @R2

!///////////////////////////////////////////////////////////////////////////////
!// end
!///////////////////////////////////////////////////////////////////////////////
    rts
    nop

!///////////////////////////////////////////////////////////////////////////////
!// BIOS FUNCTIONS: ROMFONT
!///////////////////////////////////////////////////////////////////////////////
.romfontfunc:
    mov.l ROMFONT_ROM_OFFSET, R0         ! TODO: normally we should check R0 for the subfunction
    mov.l JINGASA_ABSOLUTE_START, R1
    add R1, R0
    RTS
    NOP

!///////////////////////////////////////////////////////////////////////////////
!// Constants
!///////////////////////////////////////////////////////////////////////////////
    .align 4

JINGASA_ABSOLUTE_START:
    .long        .start

ROMFONT_ROM_OFFSET:
    .long        0x00100020
ROMFONT_VECTOR_ADDR:                     !
    .long        0xAC0000B4
ROMFONT_FUNC_ADDR:
    .long        .romfontfunc
